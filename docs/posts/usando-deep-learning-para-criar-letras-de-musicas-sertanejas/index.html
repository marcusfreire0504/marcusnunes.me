<!DOCTYPE html>
<html lang="pt-br">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">

<meta itemprop="name" content="Tutorial: Usando Deep Learning para Criar Letras de Músicas Sertanejas">
<meta itemprop="description" content="Veja como utilizar R e deep learning para gerar letras de músicas sertanejas universitárias">


<meta itemprop="datePublished" content="2018-12-12T08:54:00-03:00" />
<meta itemprop="dateModified" content="2018-12-12T08:54:00-03:00" />
<meta itemprop="wordCount" content="739">



<meta itemprop="keywords" content="curso,data science,ensino,keras,machine learning,tensor flow,tutorial," />
<meta property="og:title" content="Tutorial: Usando Deep Learning para Criar Letras de Músicas Sertanejas" />
<meta property="og:description" content="Veja como utilizar R e deep learning para gerar letras de músicas sertanejas universitárias" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/usando-deep-learning-para-criar-letras-de-musicas-sertanejas/" />
<meta property="article:published_time" content="2018-12-12T08:54:00-03:00"/>
<meta property="article:modified_time" content="2018-12-12T08:54:00-03:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tutorial: Usando Deep Learning para Criar Letras de Músicas Sertanejas"/>
<meta name="twitter:description" content="Veja como utilizar R e deep learning para gerar letras de músicas sertanejas universitárias"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Tutorial: Usando Deep Learning para Criar Letras de Músicas Sertanejas</title>
	<link rel="stylesheet" href="/css/style.min.2abea836b35631572d081e3a3c4e1ab54d8a33a8d87fa93c9b79831551fd44ce.css" integrity="sha256-Kr6oNrNWMVctCB46PE4atU2KM6jYf6k8m3mDFVH9RM4=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="/">Marcus Nunes&#39; Blog</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="/posts/">Posts</a>
					<a href="/sobre/">Sobre</a>
					<a href="/ensino/">Ensino</a>
					<a href="/pesquisa/">Pesquisa</a>
					<a href="/shiny/">Shiny</a>
					<a href="/midia/">Mídia</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://twitter.com/_marcus_nunes_" target="_blank" rel="noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://instagram.com/grandeabobora" target="_blank" rel="noopener" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg></a><a href="https://github.com/mnunes" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://pt.stackoverflow.com/users/49033/marcus-nunes" target="_blank" rel="noopener" title="Stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><a href="http://www.linkedin.com/in/marcusanunes" target="_blank" rel="noopener" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://marcusnunes.me/contato" target="_blank" rel="noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="/posts/">Posts</a></li>
			<li><a href="/sobre/">Sobre</a></li>
			<li><a href="/ensino/">Ensino</a></li>
			<li><a href="/pesquisa/">Pesquisa</a></li>
			<li><a href="/shiny/">Shiny</a></li>
			<li><a href="/midia/">Mídia</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Dec 12, 2018</span></div>
				<h1>Tutorial: Usando Deep Learning para Criar Letras de Músicas Sertanejas</h1>
			</header>
			<div class="content">
				


<div id="introdução" class="section level1">
<h1>Introdução</h1>
<p>Este é mais um post na série de tutorias deste blog. No primeiro texto eu ensinei a <a href="https://marcusnunes.me/post/primeiro-projeto-de-data-science/">fazer classificação utilizando Random Forest</a>. Hoje, como o título do post diz, eu vou mostrar como podemos utilizar a biblioteca <a href="https://keras.io/">Keras</a> para fazer o computador ler as letras das músicas de vários artistas de sertanejo universitário e ensiná-lo a produzir novas letras no estilo.</p>
<p>O procedimento completo para fazer esta tarefa está descrito logo abaixo. É possível segui-lo lendo meu texto ou, caso prefira, <a href="https://github.com/mnunes/segundo-projeto-de-data-science/">ir ao github e baixar os arquivos com o código completo e organizado</a>. Como</p>
</div>
<div id="preparação-do-software" class="section level1">
<h1>Preparação do Software</h1>
<p>Quem já possui os programas R e RStudio instalados em seu computador pode pular esta parte do tutorial. Entretanto, sugiro que <a href="https://github.com/mnunes/segundo-projeto-de-data-science/">baixe o arquivo com os códigos organizados</a> para que fique mais fácil de acompanhar este texto.</p>
<p>Há diversos programas disponíveis para fazer data science. Os dois principais são R e python. Este tutorial foi escrito pensado na linguagem R para ser rodado. Particularmente, prefiro o R ao python, pois a sintaxe dele é, para mim, mais fácil de entender. Mas isto é gosto pessoal. Tudo o que foi feito aqui pode ser adaptado e realizado em qualquer outra linguagem que o leitor prefira, como python, julia ou matlab, por exemplo.</p>
<p>Se o seu computador não possua o R e o RStudio instalado, clique nos links abaixo e instale-os.</p>
<ul>
<li><p><a href="http://cran.fiocruz.br/">R</a>: este programa é o cerne da análise. É ele que vai realizar os cálculos e plotar os gráficos da análise.</p></li>
<li><p><a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a>: a interface padrão do R não é muito amigável de utilizar. Entretanto, é possível melhorá-la para que ela fique mais interativa. Desta forma, nossa produtividade aumenta. Portanto, o RStudio serve para melhorar a utilização do R, deixando-a mais dinâmica.</p></li>
</ul>
<p>Uma característica do R é que suas funções podem ser expandidas com comandos e funções criados pela comunidade. E são milhares (se não forem milhões) de expansões assim. Estas expansões estão em pacotes que podem ser instalados via internet. Para instalar os pacotes extras necessários para esta análise, abra o RStudio e vá ao menu File &gt; New File &gt; R Script, como mostra a figura abaixo:</p>
<div class="figure">
<img src="https://marcusnunes.me/images/novo_script.png" alt="" />
<p class="caption">Novo script</p>
</div>
<p>Com o script aberto, rode o comando abaixo e aguarde. Vários arquivos serão baixados e o R vai informando o progresso da instalação.</p>
<pre class="r"><code>install.packages(c(&quot;ggwordcloud&quot;, &quot;rvest&quot;, &quot;tidyverse&quot;, &quot;tm&quot;, 
    &quot;tokenizer&quot;, &quot;keras&quot;), dependencies = TRUE)
library(keras)
install_keras()</code></pre>
<p>Este passo pode demorar um pouco, dependendo da velocidade da sua conexão com a internet.</p>
<p>Com tudo preparado, é hora de começar a análise.</p>
</div>
<div id="baixando-as-letras-das-músicas" class="section level1">
<h1>Baixando as Letras das Músicas</h1>
<p>Vamos baixar as letras de músicas dos artistas que nos interessam com uma adaptação <a href="https://www.curso-r.com/blog/2017-08-27-safadao/">deste script desenvolvido pelo pessoal do site Curso-R</a>.</p>
<pre class="r"><code>baixarLetras &lt;- function(artista) {
    # funcao adaptada do post
    # https://www.curso-r.com/blog/2017-08-27-safadao/
    link_base &lt;- &quot;https://www.letras.mus.br&quot;
    # listando os links
    artista_links &lt;- paste0(link_base, &quot;/&quot;, artista, &quot;/&quot;) %&gt;% 
        rvest::html_session() %&gt;% rvest::html_nodes(&quot;.cnt-list--alp &gt; ul &gt; li &gt; a&quot;) %&gt;% 
        rvest::html_attr(&quot;href&quot;)
    pegar_letra &lt;- function(link) {
        # do link até a parte que tem o conteúdo
        result &lt;- paste0(link_base, link) %&gt;% rvest::html_session() %&gt;% 
            rvest::html_nodes(&quot;.cnt-letra &gt; article &gt; p&quot;) %&gt;% 
            # Peguei o texto com as tags html para pegar os \n
        as.character() %&gt;% stringr::str_replace_all(&quot;&lt;[brp/]+&gt;&quot;, 
            &quot;\n&quot;) %&gt;% paste(collapse = &quot;\n\n&quot;) %&gt;% # Limpeza do texto
        limpar_musica() %&gt;% tokenizers::tokenize_characters(strip_non_alphanum = FALSE, 
            simplify = TRUE)
        c(result, &quot;@&quot;)  # Adicionando @ no final
    }
    limpar_musica &lt;- function(txt) {
        txt %&gt;% stringr::str_trim() %&gt;% stringr::str_to_lower() %&gt;% 
            stringr::str_replace_all(&quot;[^a-z0-9êâôáéíóúãõàç;,!?: \n-]&quot;, 
                &quot;&quot;) %&gt;% stringr::str_replace_all(&quot;[0-9]+x| bis&quot;, 
            &quot;&quot;) %&gt;% stringr::str_replace_all(&quot;([ ,?!])+&quot;, &quot;\\1&quot;) %&gt;% 
            stringr::str_replace_all(&quot; ([;,!?:-])&quot;, &quot;\\1&quot;) %&gt;% 
            stringr::str_replace_all(&quot;\n{3,}&quot;, &quot;\n\n&quot;)
    }
    p &lt;- progress::progress_bar$new(total = length(artista_links))
    artista_letras &lt;- unlist(purrr::map(artista_links, ~{
        p$tick()
        pegar_letra(.x)
    }))
    return(artista_letras)
}</code></pre>
<p>Dado o nome do artista, o script visita a página dele no site <a href="https://letras.mus.br">letras.mus.br</a> e identifica os links para as letras. Com os links identificados, as letras são baixadas e processadas, a fim de retirar caracteres especiais e outras sujeiras em geral.</p>
<p>Nós vamos baixar todas as letras que encontrarmos dos seguintes artistas:</p>
<p>O código para fzermos isso é o seguinte:</p>
<pre><code></code></pre>
</div>
<div id="análise-exploratória-dos-dados" class="section level1">
<h1>Análise Exploratória dos Dados</h1>
<p>Aqui estamos interessados em procurar padrões nos dados. Vamos ver coisas básicas, como as palavras mais comuns nas canções. Não será feita distinção por autor, pois estamos tentando misturar os estilos deles para gerarmos a música sertaneja que irá</p>
<p>Para encontrar as palavras mais comuns, devemos, em primeiro lugar, preparar o conjunto de dados que vamos analisar. Devemos remover as <a href="https://pt.wikipedia.org/wiki/Palavra_vazia">palavras vazias</a> dos textos, como artigos, preposições etc. Para automatizar este processo, vamos utilizar o pacote <code>tm</code>:</p>
</div>
<div id="ajuste-do-modelo" class="section level1">
<h1>Ajuste do Modelo</h1>
<p><a href="https://juliasilge.com/blog/tensorflow-generation/"></a></p>
</div>
<div id="ideias-para-novos-projetos" class="section level1">
<h1>Ideias para Novos Projetos</h1>
</div>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="2" height="2" viewBox="0 0 2 2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/curso">curso</a></span><span class="tag"><a href="/tags/data-science">data science</a></span><span class="tag"><a href="/tags/ensino">ensino</a></span><span class="tag"><a href="/tags/keras">keras</a></span><span class="tag"><a href="/tags/machine-learning">machine learning</a></span><span class="tag"><a href="/tags/tensor-flow">tensor flow</a></span><span class="tag"><a href="/tags/tutorial">tutorial</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>739 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2018-12-12 08:54 -0300</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="/posts/sera-que-as-pessoas-estao-se-interessando-mais-cedo-pelo-natal/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>Será que as Pessoas estão se Interessando Mais Cedo pelo Natal?</span>
			</a>
			<a class="prev-post" href="/posts/ciencia-de-dados-e-multidisciplinaridade/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Ciência de Dados e Multidisciplinaridade</span>
			</a>
		</div>
		<div id="comments" class="thin">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "marcus-nunes-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2013-2019 <a href="/">Marcus Nunes</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="/js/main.min.784417f5847151f848c339cf0acb13a06cbb648b1483435a28ed4556c4ead69b.js" integrity="sha256-eEQX9YRxUfhIwznPCssToGy7ZIsUg0NaKO1FVsTq1ps="></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-201649-7', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>

</html>
